import{S as D,i as T,s as b,k as g,l as _,m as y,h as d,n as E,b as w,B as K,I as M,a as k,w as H,c as $,x as N,G as x,J as R,y as V,K as C,f as J,t as j,z as A,L as O,q as P,r as q,p as I}from"../../chunks/index-b278e051.js";function z(o){let t;return{c(){t=g("div"),this.h()},l(n){t=_(n,"DIV",{id:!0}),y(t).forEach(d),this.h()},h(){E(t,"id","output")},m(n,e){w(n,t,e),o[2](t)},p:K,i:K,o:K,d(n){n&&d(t),o[2](null)}}}function B(o,t,n){let{content:e}=t,l={};function u(a){M[a?"unshift":"push"](()=>{l=a,n(0,l),n(1,e)})}return o.$$set=a=>{"content"in a&&n(1,e=a.content)},o.$$.update=()=>{o.$$.dirty&2&&n(0,l.innerHTML=e,l)},[l,e,u]}class G extends D{constructor(t){super(),T(this,t,B,z,b,{content:1})}}function X(o){let t,n,e,l,u,a,h;return l=new G({props:{id:"viewer",content:o[2],style:""}}),{c(){t=g("div"),n=g("textarea"),e=k(),H(l.$$.fragment),this.h()},l(s){t=_(s,"DIV",{id:!0,class:!0});var c=y(t);n=_(c,"TEXTAREA",{class:!0}),y(n).forEach(d),e=$(c),N(l.$$.fragment,c),c.forEach(d),this.h()},h(){E(n,"class","svelte-1wcsfwt"),E(t,"id","wrapper"),E(t,"class","svelte-1wcsfwt")},m(s,c){w(s,t,c),x(t,n),o[4](n),R(n,o[1]),x(t,e),V(l,t,null),u=!0,a||(h=[C(n,"keydown",o[3]),C(n,"input",o[5])],a=!0)},p(s,[c]){c&2&&R(n,s[1]);const m={};c&4&&(m.content=s[2]),l.$set(m)},i(s){u||(J(l.$$.fragment,s),u=!0)},o(s){j(l.$$.fragment,s),u=!1},d(s){s&&d(t),o[4](null),A(l),a=!1,O(h)}}}function Y(o){const t=o.selectionStart,n=o.value.split(`
`);let e=0;for(const l of n)if(console.log(t,e),e+=l.length+1,e>t)return l}function L(o){let t=o.selectionStart,n=0;for(;t>0&&o.value[t]!=`
`;)n++,t--;return n}function F(o,t,n){let e,l,u,a=!0;function h(i){if(console.log(i),i.code==="Tab"){i.preventDefault(),document.execCommand("insertHTML",!1,"	"),+"	"+e.value.substring(e.selectionEnd,e.value.length);return}if(i.ctrlKey&&i.code==="KeyS"){i.preventDefault(),s();return}if((i.altKey||i.code=="Escape")&&(a=!0),a){if(i.preventDefault(),i.code==="KeyI")a=!1;else if(i.code==="KeyH")e.setSelectionRange(e.selectionStart-1,e.selectionEnd-1);else if(i.code==="KeyL")console.log("KEY L"),e.setSelectionRange(e.selectionStart+1,e.selectionEnd+1);else if(i.code==="KeyJ"){const r=L(e);let v=!1,S=0;for(let p=e.selectionStart;p<e.value.length;p++){if(v){if(e.value[p]===`
`||S===r){e.setSelectionRange(p-1,p-1);return}S++}e.value[p]===`
`&&(v=!0)}return}else if(i.code==="KeyK"){const r=L(e);let v=0;for(let f=e.selectionStart;f>=0;f--){if(f===0){e.setSelectionRange(0,0);return}if(e.value[f]===`
`){v=f-1;break}}const S=Y(e).length;if(S<r){e.setSelectionRange(v,v);return}let p=0;for(let f=v;f>=0;f--){if(f===0){e.setSelectionRange(0,0);return}if(S-p===r){e.setSelectionRange(f,f);return}p++}return}else if(i.code==="KeyO"){if(a=!1,i.shiftKey){for(let r=e.selectionStart;r>0;r--)if(console.log(r),e.value[r]===`
`||r===0){n(0,e.value=e.value.slice(0,r)+`
`+e.value.slice(r),e),e.setSelectionRange(r+1,r+1);return}}else for(let r=e.selectionStart;r<=e.value.length;r++)if(e.value[r]===`
`||r===e.value.length){n(0,e.value=e.value.slice(0,r)+`
`+e.value.slice(r),e),e.setSelectionRange(r+1,r+1);return}}return}}function s(){fetch("/util/markdownToHTML",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:l})}).then(async i=>{const r=await i.json();console.log(r),n(2,u=r.markdown),setTimeout(()=>{MathJax.typesetPromise()},0)})}function c(i){M[i?"unshift":"push"](()=>{e=i,n(0,e)})}function m(){l=this.value,n(1,l)}return[e,l,u,h,c,m]}class Q extends D{constructor(t){super(),T(this,t,F,X,b,{})}}function U(o){let t,n,e,l,u,a,h;return a=new Q({}),{c(){t=g("div"),n=g("h2"),e=P("SaladNotes"),l=k(),u=g("div"),H(a.$$.fragment),this.h()},l(s){t=_(s,"DIV",{style:!0});var c=y(t);n=_(c,"H2",{});var m=y(n);e=q(m,"SaladNotes"),m.forEach(d),c.forEach(d),l=$(s),u=_(s,"DIV",{});var i=y(u);N(a.$$.fragment,i),i.forEach(d),this.h()},h(){I(t,"display","flex"),I(t,"justify-content","center")},m(s,c){w(s,t,c),x(t,n),x(n,e),w(s,l,c),w(s,u,c),V(a,u,null),h=!0},p:K,i(s){h||(J(a.$$.fragment,s),h=!0)},o(s){j(a.$$.fragment,s),h=!1},d(s){s&&d(t),s&&d(l),s&&d(u),A(a)}}}class Z extends D{constructor(t){super(),T(this,t,null,U,b,{})}}export{Z as default};
